<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>Company Bingo</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body{font-family:sans-serif;max-width:960px;margin:auto;padding:16px}
    h1{text-align:center}
    .box{border:1px solid #ccc;border-radius:8px;padding:12px;margin-top:12px}
    .nums{display:flex;flex-wrap:wrap}
    .nums button{width:44px;height:44px;margin:3px;border:1px solid #666;border-radius:6px;cursor:pointer}
    .nums button.used{background:#2196f3;color:#fff;cursor:not-allowed}
    .grid{display:grid;grid-template-columns:repeat(5,1fr);gap:6px;margin-top:8px}
    .cell{border:1px solid #999;border-radius:6px;padding:12px;text-align:center;cursor:pointer}
    .cell.mark{background:#4caf50;color:#fff}
  </style>
</head>
<body>
<h1>公司 Bingo 遊戲</h1>

<div class="box">
  房間代碼：
  <input id="room" placeholder="例如 HR2025">
  <button onclick="join()">加入房間</button>
</div>

<div class="box">
  <h3>公共報號（1～50）</h3>
  <div id="nums" class="nums"></div>
  <p>已報：<span id="list"></span></p>
</div>

<div class="box">
  <h3>我的 Bingo 卡</h3>
  <button onclick="gen()">生成 / 刷新</button>
  <div id="card" class="grid"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script>
/* ⚠️ 下一步你會把這一段換成 Firebase 的設定 */
const firebaseConfig = {
  apiKey: "貼Firebase的apiKey",
  authDomain: "貼Firebase的authDomain",
  databaseURL: "貼Firebase的databaseURL",
  projectId: "貼projectId"
};

firebase.initializeApp(firebaseConfig);
const db=firebase.database();

let room="",called=[],my=[];

/* 公共號碼 */
const nums=document.getElementById("nums");
for(let i=1;i<=50;i++){
  let b=document.createElement("button");
  b.textContent=i;
  b.onclick=()=>call(i);
  nums.appendChild(b);
}

function join(){
  room=document.getElementById("room").value;
  if(!room)return alert("請輸入房間代碼");
  db.ref("rooms/"+room).on("value",s=>{
    called=s.val()||[];
    update();
  });
}

function call(n){
  if(called.includes(n))return;
  called.push(n);
  called.sort((a,b)=>a-b);
  db.ref("rooms/"+room).set(called);
}

function update(){
  [...nums.children].forEach(b=>{
    let n=+b.textContent;
    b.className=called.includes(n)?"used":"";
  });
  document.getElementById("list").textContent=called.join(",");
  mark();
}

/* Bingo 卡 */
function gen(){
  let pool=[...Array(50)].map((_,i)=>i+1);
  my=[];
  while(my.length<25){
    my.push(pool.splice(Math.floor(Math.random()*pool.length),1)[0]);
  }
  const c=document.getElementById("card"); c.innerHTML="";
  my.forEach(n=>{
    let d=document.createElement("div");
    d.textContent=n;
    d.className="cell";
    d.onclick=()=>d.classList.toggle("mark");
    c.appendChild(d);
  });
}

function mark(){
  document.querySelectorAll(".cell").forEach(c=>{
    if(called.includes(+c.textContent))c.classList.add("mark");
  });
}
</script>
</body>
</html>
